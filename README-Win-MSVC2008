Welcome to Hermes2D!                                                                                                                                                                                 

This is README for building and using Hermes2D using Microsoft Visual C++ 2008 (Express Edition). These instructions should probably work even for older versions of MS Visual C++ up to version 2003.

* Known limitations and issues
 - all three stand-alone viewers do not compile
 - Trilinos not supported
 - Python not supported

* Building Hermes2D
 In order to build the library and examples, you need to:
 1) Prepare dependecy libraries, see 'Dependency Check-list'
 2) Copy a file 'my_hermes_root\MSVC2008\CMake.vars' to 'my_hermes_root'. The file contains settings for the projekct.
 3) Modify the file 'my_hermes_root\CMake.vars'. Only the first line has to be modified, the rest of lines depends on project settings. Please, follow comments in the file.
 4) In the directory 'my_hermes_root', run CMAKE using: 'cmake . -G "Visual Studio 9 2008". This will create project files.
 5) Open a SLN file 'my_hermes_root\hermes2d.sln' and build Hermes2d. Actually, this step is not necessary if you plan to use Hermes2d in your projects rather than explore tutorials.

* Hermes2d configuration options
 Hermes2d is configured through preprocessor directives. Directives are generated by CMAKE and your settings might be overriden by CMAKE. The directives are:
 NOGLUT : excludes GLUT-dependant parts. This replaces viewers with an empty implementation that does nothing if invoked.
	- if used, a library 'freeglut.lib' does not need to be linked
 ENABLE_VIEWER_GUI : enables GUI for viewers. Currently, only 'ScalarView' support GUI because this is an experimental feature. This directive is mutually exclusive with NOGLUT.
	- if used, a library 'AntTweakBar.lib' does not need to be linked

* Using Hermes2d
 In order to used Hermes2d in your project, you need to do following steps. Steps has 5, 6, and 7 to be repeated for every configuration, i.e., Debug, Release. Except the step 7b, this can be done easily by setting the drop-down Configuration to 'All configurations' in the Project Property dialog.
 1) Prepare Hermes2d to be buildable by MSVC, see 'Building Hermes2D'
 2) Create your project in MSVC. Set the project to be empty Win32 console project.
 3) Add either 'my_hermes2d_root\src\hermes2d-real.vcproj' or 'my_hermes2d_root\src\hermes2d-cplx.vcproj' project to your solution (<right click on solution>\Add\Existing Project...)
 4) Set that your project depends on hermes2d-* project (<right click on your project>\Project Dependences...)
 5) Add directories 'my_hermes2d_directory\src' and 'dependencies\include' to additional include directories (<right click on your project>\Properties\Configuration Properties\C/C++\Additional Include Directories)
 6) Add directories 'dependencies\lib' to additional library directories (<right click on your project>\Properties\Configuration Properties\Linker\Additional Library Directories)
 7) Deny warnings that are not indicating anything dangerous:
 7a) Avoid warnings about STL in DLL by denying a warning 4251 (<right click on your project>\Properties\Configuration Properties\C/C++\Advanced\Disable Specific Warnings, enter 4251)
 7b) Avoid warnings about standard functions that are not safe (<right click on your project>\Properties\Configuration Properties\C/C++\Preprocessor\Preprocessor Definitions, add _CRT_SECURE_NO_WARNINGS)
 
* Dependency check-list
 This list works for 32-bit version of Hermes2D. If you intend to cross-compile 64-bit version, you have to cross-compile all libraries.
 1) Create directory structure
	- in order to create the structure, execute 'prepare_dep_dir.bat'. Be sure to include a directory 'dependecies\bin' into 'PATH' environment variable.
	- all Hermes2d project files assumes that dependency libraries are available in a fixed directory structure. The root of this structure has to have the same parent as does Hermes2d director, i.e., if 'C:\my_work\hermes2d\' is a root of the Hermes2D directory, then 'C:\my_work\dependecies\' is a root of the dependency directory. Subdirectories are:
		> dependencies\include: Header files (*.h) of dependency libraries.
		> dependencies\lib: Library files (*.lib) of dependency libraries.
		> dependencies\bin: Binary modules (*.dll) of dependency libraries. Be sure to include a directory 'dependecies\bin' into 'PATH' environment variable.
	
 2) JUDY
	- download judy (http://sourceforge.net/projects/judy/) and upack it
	- open a command promt with MSVC variables set up: either use a command prompt in MSVC start menu or start a command prompt and execute VCVARS.BAT from the MSVC directory
	- switch to a directory containing JUDY sources, e.g., 'my_judy_root/src'
	- compile JUDY with 'build.bat': this creates Judy.dll and Judy.lib
	- copy 'Judy.dll', 'Judy.h', and 'Judy.lib' to 'bin', 'include', and 'lib' dependecy directories respectively

 3) PTHREAD
    - download pthread binaries version 2.8.0 (ftp://sourceware.org/pub/pthreads-win32/)
	- copy 'lib\pthreadVCE2.dll', 'include\*.h' and 'lib\pthreadVCE2.lib' to 'bin', 'include', and 'lib' dependecy directories respectively

 4) UMFPACK
 4a) UFConfig
	- download UFconfig source file package (http://www.cise.ufl.edu/research/sparse/UFconfig/)
	- upack it
	- copy UFconfig.h to 'include' dependecy directory

 4b) AMD
	- download AMD source file package (http://www.cise.ufl.edu/research/sparse/amd/)
	- unpack source file into a directory that has the same parent as a directory where you unpacked UFconfig
	- copy a file 'my_hermes2d_root\MSVC2008\AMD.nmake' to a directory 'my_amd_directory\Lib'
	- run MSVC command prompt similar as in the case of Judy and switch to 'my_amd_directory\Lib'
	- compile AMD using 'nmake -f AMD.nmake'
	- copy 'amd.h', 'amd_internal.h', and 'libamd.lib' to 'include', and 'lib' dependecy directories respectively

 4c) UMFPACK
	- download UMFPACK source file package (http://www.cise.ufl.edu/research/sparse/umfpack/current/)
	- unpack source file into a directory that has the same parent as a directory where you unpacked UFconfig
	- copy a file 'my_hermes2d_root\UMFPACK.nmake' to the 'my_umfpack_root/Lib' directory
	- run MSVC command prompt similar as in the case of Judy and switch to 'my_umfpack_root\Lib'
	- compile UMFPACK using 'nmake -f UMFPACK.nmake'. Linking might take some time, please, be patient.
	- copy 'libumfpack.dll', all include files, and 'libumfpack.lib' to 'bin', 'include', and 'lib' dependecy directories respectively

 5) CMAKE
	- download CMAKE (http://www.cmake.org/cmake/resources/software.html) version 2.6.X at minimum
	- install CMAKE such that it is accessible from every location
	
 6) OpenGL support (optional)
    - if a directive NOGLUT is used, this step and all its substeps can be skipped

 6a) FREEGLUT 
    - download freeglut 2.6.0 (http://freeglut.sourceforge.net/) and unpack it
	- open a DSW or DSP file in MSVC, MSVC will convert file into a newer format, i.e., SLN or VCPROJ
	- compile either Debug or Release version. Debug version is recommended in a case of debugging.
	- copy 'freeglut.dll', 'freeglut.h', and 'freeglut.lib' to 'bin', 'include', and 'lib' dependency directories respectively
  
 6b) GLEW
    - download glew 1.5.2 (http://glew.sourceforge.net/) and unpack it
	- open a DSW file 'my_glew_root/builds/vc6' and let MSVC to convert it 
    - switch to 'Release' version
	- build a project 'glew_shared': this will create DLL file
	- copy 'my_glew_root/bin/glew32.dll', 'my_glew_root/include/GL/*.h', and 'my_glew_root/bin/glew32.lib' to 'bin', 'include/GL', and 'lib' dependency directories respectively
 	
 7) AntTweakBar (optional)
	- if a directive ENABLE_VIEWER_GUI is *not* used, this step can be skipped
	- download a modified version 1.1.3 of AntTweakView (http://hpfem.org/hermes2d/)
	- unpack it
	- open SLN file in MSVC and compile it
	- copy 'AntTweakBar.dll', 'AntTweakBar.h', and 'AntTweakBar.lib' to 'bin', 'include', and 'lib' dependency directories respectively
	
 8) ExodusII (optional)
	- if a directive WITH_EXODUSII is *not* used, this step including all sub-steps can be skipped
	
 8a) Zlib
    - download sources of version 1.2.3 (http://www.zlib.net/) and unpack them
	- open 'my_zlib_root/projects/visualc6/zlib.dsw' (Visual C++ 6 Solution File) in MSVC and let MSVC to convert it
	- switch a configuration to 'Release DLL'
	- build project 'zlib': this will create DLL/LIB files in 'my_zlib_root/projects/visual6/Win32_DLL_Release'
	- copy 'zlib1.dll', 'zlib.h', and 'zlib1.lib' to 'bin', 'include', and 'lib' dependency directories respectively
 
 8b) HDF5
    - download sources of version 1.8 (ftp://ftp.hdfgroup.org/HDF5/current/src/) and unpack them
	- since SLIB is not used, comment out a line '#define H5_HAVE_FILTER_SZIP 1' in the header file 'my_hdf5_root/windows/src/H5pubconf.h'
	- copy the file 'my_hdf5_root/windows/src/H5pubconf.h' to the directory 'my_hdf5_root/src/'
	- run MSVC Command Prompt and switch to a directory 'my_hdf5_root/windows/proj'
	- set variable HDF5_EXT_ZLIB to 'my_dependencies\lib\zlib1.lib', e.g.,
	  set HDF5_EXT_ZLIB="C:\fem\dependencies\lib\zlib1.lib"
	- if SLIB is used, set variable HDF5_EXT_SLIB similarly, .e.g,
	  set HDF5_EXT_SLIB="C:\fem\dependencies\lib\slib.lib"
	- open SLN file in MSVC executing 'VCExpress.exe all/all.sln' in the command prompt and let MSVC to convert files
	- switch a configuration to 'Release'
	- build project 'hdf5_hldll': this will create DLL/LIB files in 'my_hdf5_root/proj/hdf5_hldll/Release/' and 'my_hdf5_root/proj/hdf5dll/Release/'
	- copy 'hdf5dll.dll' and 'hdf5dll.lib' to 'bin' and 'lib' dependency directories respectively
	- copy 'hdf5_hldll.dll' and 'hdf5_hldll.lib' to 'bin' and 'lib' dependency directories respectively
 
 8c) NetCDF
    - download sources of version 4.0.1 (http://www.unidata.ucar.edu/downloads/netcdf/netcdf-4_0_1/index.jsp) and unpack them
    - open a SLN file 'my_netcfd_root/win32/NET/netcdf.sln'
    - switch to 'Release' version
    - in properties of the project 'netcdf'
        > add paths 'my_hdf5_root/src/' and 'my_hdf5_root/hl/src' to 'C/C++ \ Additional Include Directories'
        > add a path 'dependencies/lib/' to 'Linker \ Additional Library Directories'
    - build project 'netcdf': this will create DLL/LIB files in 'my_netcdf_root/win32/NET/Release'
    - copy 'netcdf.dll' and 'netcdf.lib' to 'bin' and 'lib' dependency directories respectively
    - copy 'my_netcdf_root/libsrc4/netcdf.h' to 'include' dependency directory

 8d) ExodusII
    - download sources (http://sourceforge.net/projects/exodusii/) and unpack 'exodusii'
    - add a line 'set(NETCDF_INCLUDE_DIR "my_netcdf_root/libsrc4")' to a file 'my_exodusii_root/CMakeLists.txt' just after the line 'PROJECT(Exodusii)', .e.g.,
        set(NETCDF_INCLUDE_DIR "C:/fem/dependencies/src/netcdf-4.0.1/libsrc4") # Be sure to use a slash '/' instead of a backslash '\'
    - generate MSVC project files using CMAKE, i.e., in command prompt run
        cmake . -G "Visual Studio 9 2008"
    - open a SLN file 'my_exodusii_root/ExodusII.sln' in MSVC
    - switch to 'Release' version
    - build a project 'exoIIv2c': this will create a LIB file in 'my_exodusii_root/cbind/Release'
    - copy 'exoIIv2c.lib' to 'lib' dependency directory structure
    - copy 'my_exodusii_root/cbind/include/exodusII.h' and 'my_netcdf_root/libsrc4/exodusII_ext.h' to 'include' dependency directory
	